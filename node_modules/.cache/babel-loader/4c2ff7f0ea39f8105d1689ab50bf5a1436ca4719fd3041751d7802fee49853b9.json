{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport router from '../router';\nimport { APIService } from \"../http/APIService\";\nconst apiService = new APIService();\nexport default {\n  name: \"Auth\",\n  data: () => ({\n    credentials: {},\n    valid: true,\n    showMsg: \"\",\n    loading: false,\n    rules: {\n      username: [v => !!v || \"Username is required\", v => v && v.length > 3 || \"A username must be more than 3 characters long\", v => /^[a-z0-9_]+$/.test(v) || \"A username can only contain letters and digits\"],\n      password: [v => !!v || \"Password is required\", v => v && v.length > 7 || \"The password must be longer than 7 characters\"]\n    },\n    showPassword: false\n  }),\n  methods: {\n    login() {\n      localStorage.clear();\n      localStorage.setItem(\"isAuthenticated\", false);\n      apiService.authenticateLogin(this.credentials).then(response => {\n        const access = response.data.access;\n        const refresh = response.data.refresh;\n        localStorage.setItem(\"access\", access);\n        localStorage.setItem(\"refresh\", refresh);\n        localStorage.setItem(\"isAuthenticated\", \"true\");\n        localStorage.setItem(\"log_user\", JSON.stringify(this.credentials.username));\n        apiService.getUser().then(response => {\n          console.log(\"User API Response:\", response.data);\n          if (response.data) {\n            localStorage.setItem(\"is_superuser\", JSON.stringify(response.data.is_superuser));\n            localStorage.setItem(\"userID\", String(response.data.pk));\n            localStorage.setItem(\"validUserName\", response.data.username);\n          } else {\n            console.error(\"Error: API did not return user data.\");\n          }\n          setTimeout(() => {\n            window.location = \"/\";\n          }, 500);\n        }).catch(error => {\n          console.error(\"User Fetch Error:\", error);\n          this.showMsg = \"axiosError\";\n        });\n      }).catch(error => {\n        console.error(\"Login Error:\", error);\n        if (error.message === \"Network Error\") {\n          this.showMsg = \"axiosError\";\n        } else if (error.response && error.response.status === 401) {\n          this.showMsg = \"loginError\";\n          router.push(\"/auth\");\n        } else if (error.response && error.response.status === 400) {\n          this.showMsg = \"loginError\";\n        } else {\n          this.showMsg = \"axiosError\";\n          router.push(\"/auth\");\n        }\n      });\n    }\n  }\n};","map":{"version":3,"names":["router","APIService","apiService","name","data","credentials","valid","showMsg","loading","rules","username","v","length","test","password","showPassword","methods","login","localStorage","clear","setItem","authenticateLogin","then","response","access","refresh","JSON","stringify","getUser","console","log","is_superuser","String","pk","error","setTimeout","window","location","catch","message","status","push"],"sources":["/Users/leothecub/PycharmProjects/pythonActivities/investments-fe2/src/components/Auth.vue"],"sourcesContent":["<template>\n    <div class=\"container\">\n    <div class=\"row align-items-center justify-content-center\">\n      <div class=\"col-12 col-sm-6 col-md-4 col-lg-4\">\n        <div class=\"card mx-auto shadow\">\n          <div class=\"card-body\">\n            <div class=\"card-title\"><span>Login</span></div>\n            <div\n              v-if=\"showMsg === 'loginError'\"\n              close-icon=\"mdi-close-circle\"\n              :value=\"true\"\n              class=\"alert alert-danger\"\n              role=\"alert\"\n              dense\n            >\n              Invalid username or password. Please Try again.\n            </div>\n            <div\n              v-else-if=\"showMsg === 'axiosError'\"\n              close-icon=\"mdi-close-circle\"\n              :value=\"true\"\n              class=\"alert alert-danger\"\n              role=\"alert\"\n              dense\n            >\n              Access blocked by server. Check server.\n            </div>\n            <div class=\"card-text pt-2\">\n              <div class=\"col-md-10 mb-3\">\n                <div class=\"input-group\">\n                  <div class=\"input-group-prepend\">\n                    <span class=\"input-group-text\">@</span>\n                  </div>\n                  <input\n                    v-model=\"credentials.username\"\n                    :counter=\"70\"\n                    label=\"Username\"\n                    :rules=\"rules.username\"\n                    maxlength=\"70\"\n                    required\n                    type=\"text\"\n                    class=\"form-control mb-3\"\n                    placeholder=\"Username\"\n                    aria-describedby=\"inputGroupPrepend2\"\n                  />\n                  <div class=\"w-100\"></div>\n                  <div class=\"input-group-prepend\">\n                    <span class=\"input-group-text\">***</span>\n                  </div>\n                  <input\n                    :type=\"showPassword ? 'text' : 'Password'\"\n                    v-model=\"credentials.password\"\n                    label=\"Password\"\n                    :rules=\"rules.password\"\n                    maxlength=\"20\"\n                    required\n                    :append-icon=\"showPassword ? 'mdi-eye' : 'mdi-eye-off'\"\n                    @click:append=\"showPassword = ! showPassword\"\n                    class=\"form-control\"\n                    placeholder=\"Password\"\n                    aria-describedby=\"inputGroupPrepend2\"\n                  />\n                </div>\n              </div>\n              <button ref =\"form\" @click.prevent=\"login\" class=\"btn btn-primary\">Login</button>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n  </template>\n  <script>\n  import router from '../router';\n  import { APIService } from \"../http/APIService\";\n  const apiService = new APIService();\n  \n  export default {\n  name: \"Auth\",\n  data: () => ({\n      credentials: {},\n      valid: true,\n      showMsg: \"\",\n      loading: false,\n      rules: {\n        username: [\n          (v) => !!v || \"Username is required\",\n          (v) =>\n            (v && v.length > 3) ||\n            \"A username must be more than 3 characters long\",\n          (v) =>\n            /^[a-z0-9_]+$/.test(v) ||\n            \"A username can only contain letters and digits\",\n        ],\n        password: [\n          (v) => !!v || \"Password is required\",\n          (v) =>\n            (v && v.length > 7) ||\n            \"The password must be longer than 7 characters\",\n        ],\n      },\n      showPassword: false,\n    }),\n    methods: {\n      login() { \n\nlocalStorage.clear(); \n\nlocalStorage.setItem(\"isAuthenticated\", false); \n\n\n\napiService.authenticateLogin(this.credentials) \n\n    .then((response) => { \n\n        const access = response.data.access; \n\n        const refresh = response.data.refresh; \n\n        localStorage.setItem(\"access\", access); \n\n        localStorage.setItem(\"refresh\", refresh); \n\n        localStorage.setItem(\"isAuthenticated\", \"true\");  \n\n\n\n        localStorage.setItem(\"log_user\", JSON.stringify(this.credentials.username)); \n\n\n\n        apiService.getUser() \n\n            .then((response) => { \n\n                console.log(\"User API Response:\", response.data);  \n\n                if (response.data) { \n\n                    localStorage.setItem(\"is_superuser\", JSON.stringify(response.data.is_superuser));  \n\n                    localStorage.setItem(\"userID\", String(response.data.pk)); \n\n                    localStorage.setItem(\"validUserName\", response.data.username); \n\n                } else { \n\n                    console.error(\"Error: API did not return user data.\"); \n\n                } \n\n\n\n                setTimeout(() => { \n\n                    window.location = \"/\"; \n\n                }, 500); \n\n            }) \n\n            .catch(error => { \n\n                console.error(\"User Fetch Error:\", error); \n\n                this.showMsg = \"axiosError\"; \n\n            }); \n\n    }) \n\n    .catch(error => { \n\n        console.error(\"Login Error:\", error); \n\n        if (error.message === \"Network Error\") { \n\n            this.showMsg = \"axiosError\"; \n\n        } else if (error.response && error.response.status === 401) { \n\n            this.showMsg = \"loginError\"; \n\n            router.push(\"/auth\"); \n\n        } else if (error.response && error.response.status === 400) { \n\n            this.showMsg = \"loginError\"; \n\n        } else { \n\n            this.showMsg = \"axiosError\"; \n\n            router.push(\"/auth\"); \n\n        } \n\n    }); \n\n} \n\n\n      }\n  }\n  </script>\n  "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}